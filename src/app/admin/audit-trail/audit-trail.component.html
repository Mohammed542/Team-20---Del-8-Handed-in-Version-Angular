<div class="p-1">
  <div class="m-5">
    <div class="m-5" style="display: flex; justify-content: center">
      <div>
        <h1>Audit Trail</h1>
      </div>
    </div>
    <div class="col-12 d-flex">
      <form [formGroup]="formGroup" style="width: 100%;">
        <div class="col-12">
          <div class="col-12 d-flex">
            <div class="col-2">
              <mat-form-field appearance="fill" style="width: 95%;">
                <mat-label>Start Date</mat-label>
                <input matInput formControlName="startDate" [matDatepicker]="picker">
                <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                <mat-datepicker #picker></mat-datepicker>
              </mat-form-field>
            </div>
            <div class="col-2">
              <mat-form-field appearance="fill" style="width: 95%;">
                <mat-label>End Date</mat-label>
                <input matInput formControlName="endDate" [matDatepicker]="picker1">
                <mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
                <mat-datepicker #picker1></mat-datepicker>
              </mat-form-field>
            </div>
            <div class="col-2">
              <mat-form-field appearance="fill" style="width: 95%;">
                <mat-label>Email Address</mat-label>
                <input matInput formControlName="emailAddress" />
              </mat-form-field>
            </div>
            <div class="col-2">
              <mat-form-field appearance="fill" style="width: 95%;">
                <mat-label>Full Name</mat-label>
                <input matInput formControlName="fullName" />
              </mat-form-field>
            </div>
            <div class="col-2">
              <mat-form-field appearance="fill" style="width: 95%;">
                <mat-label>Transaction Type</mat-label>
                <input matInput formControlName="transactionType" />
              </mat-form-field>
            </div>
            <div class="col-2">
              <mat-form-field appearance="fill" style="width: 95%;">
                <mat-label>Critical Data</mat-label>
                <input matInput formControlName="criticalData" />
              </mat-form-field>
            </div>
          </div>
          <div class="col-12 d-flex" style="justify-content: flex-end; height: fit-content; margin-top: auto;  margin-bottom: auto;">
            <button mat-raised-button color="primary" [class.spinner]="loading" [disabled]="loading" (click)="onLoadData()">Search</button>
          </div>
        </div>
      </form>
    </div>
    <table aria-describedby="table" mat-table [dataSource]="dataSource" matSort matSortActive="Date"
      matSortDirection="asc" class="mat-elevation-z8 col-12 mb-5">
      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell" colspan="6" style="text-align: center;">
          There are no audit trail items for search criteria provided
        </td>
      </tr>
      <ng-container matColumnDef="Date">
        <th id="Date" mat-header-cell *matHeaderCellDef mat-sort-header>Date</th>
        <td mat-cell *matCellDef="let item">
          {{ item.AuditTrailDate | date: "yyyy-MM-dd" }}
        </td>
      </ng-container>
      <ng-container matColumnDef="Time">
        <th id="Time" mat-header-cell *matHeaderCellDef mat-sort-header>Time</th>
        <td mat-cell *matCellDef="let item">
          {{ item.AuditTrailDate | date: "HH:mm:ss"}}
        </td>
      </ng-container>
      <ng-container matColumnDef="Email">
        <th id="Email" mat-header-cell *matHeaderCellDef mat-sort-header>Email</th>
        <td mat-cell *matCellDef="let item">
          {{ item.UserEmailAddress }}
        </td>
      </ng-container>
      <ng-container matColumnDef="FullName">
        <th id="FullName" mat-header-cell *matHeaderCellDef mat-sort-header>FullName</th>
        <td mat-cell *matCellDef="let item">
          {{ item.UserFullName }}
        </td>
      </ng-container>
      <ng-container matColumnDef="TransactionType">
        <th id="TransactionType" mat-header-cell *matHeaderCellDef mat-sort-header>Transaction Type</th>
        <td mat-cell *matCellDef="let item">
          {{ item.TransactionType }}
        </td>
      </ng-container>
      <ng-container matColumnDef="CriticalData">
        <th id="CriticalData" mat-header-cell *matHeaderCellDef mat-sort-header>Critical Data</th>
        <td mat-cell *matCellDef="let item">
          {{ item.CriticalData }}
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>
    
    <mat-paginator [pageSizeOptions]="[5, 10, 15, 20, 30, 50]" showFirstLastButtons aria-label="Select Page"></mat-paginator>
  </div>
</div>
