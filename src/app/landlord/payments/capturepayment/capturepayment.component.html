<div class="main-div">
    <form [formGroup]="form" (ngSubmit)="onSubmit(form.value)">
    <h1>Capture Payment</h1>

    <!-- <div class="container">
        <div class="row">
            <div class="left-div col-lg-6">
                <div class="control-div">
                    <label>Payment Name:</label>

                    <mat-form-field appearance="fill">
                        <input matInput>
                    </mat-form-field>
                </div>

                <div class="control-div">
                    <label>Payment Amount:</label>

                    <mat-form-field appearance="fill">
                        <mat-icon matPrefix>R</mat-icon>
                        <input matInput>
                    </mat-form-field>
                </div>

                <div class="control-div">
                    <label>Payment Type:</label>

                    <mat-form-field appearance="fill">
                        <mat-label>Select Payment Type</mat-label>
                        <mat-select>
                            <mat-option value="one">First option</mat-option>
                            <mat-option value="two">Second option</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>

                <div class="control-div">
                    <label>Payment Method:</label>

                    <mat-form-field appearance="fill">
                        <mat-label>Select Payment Method</mat-label>
                        <mat-select>
                            <mat-option value="one">First option</mat-option>
                            <mat-option value="two">Second option</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
            </div>

            <div class="right-div col-lg-6">
                <div class="control-div">
                    <label>Payment Status:</label>

                    <mat-form-field appearance="fill">
                        <mat-label>Select Payment Status</mat-label>
                        <mat-select>
                            <mat-option value="one">First option</mat-option>
                            <mat-option value="two">Second option</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>

                <div class="control-div">
                    <label>Date:</label>

                    <mat-form-field appearance="fill">
                        <mat-label>Choose a date</mat-label>
                        <input matInput [matDatepicker]="picker">
                        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                        <mat-datepicker #picker></mat-datepicker>
                    </mat-form-field>
                </div>

                <div class="control-div">
                    <label>Tenant to Charge:</label>

                    <mat-form-field appearance="fill">
                        <mat-label>Select Tenant</mat-label>
                        <mat-select>
                            <mat-option value="one">First option</mat-option>
                            <mat-option value="two">Second option</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>

                <div class="control-div">
                    <label>Unit Number:</label>

                    <mat-form-field appearance="fill">
                        <mat-label>Select Unit Number</mat-label>
                        <mat-select>
                            <mat-option value="one">First option</mat-option>
                            <mat-option value="two">Second option</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
            </div>
        </div>
    </div> -->

    <!-- <div class="container-fluid">
        <div class="row">
            <div class="col-lg-6">
                <div class="row">
                    <div class="col-md-6 left-div">
                        <label>Payment Name:</label>
                    </div>
                    <div class="col-md-6">
                        <mat-form-field appearance="fill">
                            <input matInput>
                        </mat-form-field>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="row">
                    <div class="col-md-6 left-div">
                        <label>Payment Status:</label>
                    </div>
                    <div class="col-md-6">
                        <mat-form-field appearance="fill">
                            <mat-label>Select Payment Status</mat-label>
                            <mat-select>
                                <mat-option value="one">First option</mat-option>
                                <mat-option value="two">Second option</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-6">
                <div class="row">
                    <div class="col-md-6 left-div">
                        <label>Payment Amount:</label>
                    </div>
                    <div class="col-md-6">
                        <mat-form-field appearance="fill">
                            <mat-icon matPrefix>R</mat-icon>
                            <input matInput>
                        </mat-form-field>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="row">
                    <div class="col-md-6 left-div">
                        <label>Date:</label>
                    </div>
                    <div class="col-md-6">
                        <mat-form-field appearance="fill">
                            <mat-label>Choose a date</mat-label>
                            <input matInput [matDatepicker]="picker">
                            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                            <mat-datepicker #picker></mat-datepicker>
                        </mat-form-field>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-6">
                <div class="row">
                    <div class="col-md-6 left-div">
                        <label>Payment Type:</label>
                    </div>
                    <div class="col-md-6">
                        <mat-form-field appearance="fill">
                            <mat-label>Select Payment Type</mat-label>
                            <mat-select>
                                <mat-option value="one">First option</mat-option>
                                <mat-option value="two">Second option</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="row">
                    <div class="col-md-6 left-div">
                        <label>Tenant to Charge:</label>
                    </div>
                    <div class="col-md-6">
                        <mat-form-field appearance="fill">
                            <mat-label>Select Tenant</mat-label>
                            <mat-select>
                                <mat-option value="one">First option</mat-option>
                                <mat-option value="two">Second option</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-6">
                <div class="row">
                    <div class="col-md-6 left-div">
                        <label>Payment Method:</label>
                    </div>
                    <div class="col-md-6">
                        <mat-form-field appearance="fill">
                            <mat-label>Select Payment Method</mat-label>
                            <mat-select>
                                <mat-option value="one">First option</mat-option>
                                <mat-option value="two">Second option</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="row">
                    <div class="col-md-6 left-div">
                        <label>Unit Number:</label>
                    </div>
                    <div class="col-md-6">
                        <mat-form-field appearance="fill">
                            <mat-label>Select Unit Number</mat-label>
                            <mat-select>
                                <mat-option value="one">First option</mat-option>
                                <mat-option value="two">Second option</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </div>
            </div>
        </div>
    </div> -->

    <div class="container-fluid">
        <div class="row control-div">
            <div class="col-lg-6">
                <div class="row">
                    <div class="col-md-6 left-div">
                        <label>Payment Name:</label>
                    </div>
                    <div class="col-md-6">
                        <mat-form-field appearance="fill">
                            <input matInput formControlName="PaymentName">
                            <mat-hint align="end">Please provide a payment name.</mat-hint>
                            <mat-error *ngIf="form.controls.PaymentName.invalid">{{getErrorMessage("name")}}</mat-error>
                        </mat-form-field>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <!-- <div class="row">
                    <div class="col-md-6 left-div">
                        <label>Payment Status:</label>
                    </div>
                    <div class="col-md-6">
                        <mat-form-field appearance="fill">
                            <mat-label>Select Payment Status</mat-label>
                            <mat-select>
                                <mat-option value="one">First option</mat-option>
                                <mat-option value="two">Second option</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </div> -->
                <div class="row">
                    <div class="col-md-6 left-div">
                        <label>Payment Method:</label>
                    </div>
                    <div class="col-md-6">
                        <mat-form-field appearance="fill">
                            <mat-label>Select Payment Method</mat-label>
                            <!-- <mat-select>
                                <mat-option value="one">First option</mat-option>
                                <mat-option value="two">Second option</mat-option>
                            </mat-select> -->
                            <mat-select (selectionChange)="onMethodChange($event)" formControlName="PaymentMethodID">
                                <mat-option *ngFor="let methods of allMethods" [value]="methods.PaymentMethodID">{{ methods.Description }}</mat-option>
                            </mat-select>
                            <mat-hint align="end">Select the Payment Method.</mat-hint>
                            <mat-error *ngIf="form.controls.PaymentMethodID.invalid">{{getErrorMessage("method")}}</mat-error>
                        </mat-form-field>
                    </div>
                </div>
            </div>
        </div>

        <div class="row control-div">
            <!-- <div class="col-lg-6">
                <div class="row">
                    <div class="col-md-6 left-div">
                        <label>Payment Amount:</label>
                    </div>
                    <div class="col-md-6">
                        <mat-form-field appearance="fill">
                            <mat-icon matPrefix>R</mat-icon>
                            <input matInput type="text" formControlName="PaymentAmount">
                        </mat-form-field>
                    </div>
                </div>
            </div> -->
            <div class="col-lg-6">
                <div class="row">
                    <div class="col-md-6 left-div">
                        <label>Payment Amount:</label>
                    </div>
                    <div class="col-md-6">
                        <mat-form-field appearance="fill">
                            <mat-icon matPrefix>R</mat-icon>

                            <input type="text" matInput formControlName="Amount">
                            <mat-hint align="end">Provide the amount that has been paid.</mat-hint>
                            <mat-error *ngIf="form.controls.Amount.invalid">{{getErrorMessage("amount")}}</mat-error>
                        </mat-form-field>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="row">
                    <div class="col-md-6 left-div">
                        <label>Date:</label>
                    </div>
                    <div class="col-md-6">
                        <mat-form-field appearance="fill">
                            <mat-label>Choose a date</mat-label>
                            <input matInput [matDatepicker]="picker" [min]="minDate" [max]="maxDate" formControlName="Date" disabled>
                            <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
                            <mat-datepicker #picker disabled="false"></mat-datepicker>
                            <mat-hint align="end">Choose the date of the payment.</mat-hint>
                            <mat-error *ngIf="form.controls.Date.invalid">{{getErrorMessage("date")}}</mat-error>
                        </mat-form-field>
                    </div>
                </div>
            </div>
        </div>

        <div class="row control-div">
            <div class="col-lg-6">
                <!-- <div class="row">
                    <div class="col-md-6 left-div">
                        <label>Payment Type:</label>
                    </div>
                    <div class="col-md-6">
                        <mat-form-field appearance="fill">
                            <mat-label>Select Payment Type</mat-label>
                            <mat-select>
                                <mat-option value="one">First option</mat-option>
                                <mat-option value="two">Second option</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </div> -->
                <div class="row">
                    <div class="col-md-6 left-div">
                        <label>Building:</label>
                    </div>
                    <div class="col-md-6">
                        <mat-form-field appearance="fill">
                            <mat-label>Select Building</mat-label>
                            <mat-select (selectionChange)="onBuildingChange($event)" formControlName="BuildingID">
                                <mat-option *ngIf="form.controls.BuildingID.value != '' && form.controls.BuildingID.value != undefined" [value]="none">None</mat-option>
                                <mat-option *ngIf="allBuildings.length == 0" disabled>No Buildings</mat-option>
                                <mat-option *ngFor="let buildings of allBuildings" [value]="buildings.Building.BuildingID">{{ buildings.Building.BuildingName }}</mat-option>
                            </mat-select>
                            <mat-hint align="end">Click the dropdown to select</mat-hint>
                            <mat-error *ngIf="form.controls.BuildingID.invalid">{{getErrorMessage("building")}}</mat-error>
                        </mat-form-field>
                    </div>
                </div>
            </div>
            <div class="col-lg-6">
                <!-- <div class="row">
                    <div class="col-md-6 left-div">
                        <label>Building:</label>
                    </div>
                    <div class="col-md-6">
                        <mat-form-field appearance="fill">
                            <mat-label>Select Building</mat-label>
                            <mat-select>
                                <mat-option value="one">First option</mat-option>
                                <mat-option value="two">Second option</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </div> -->
                <div class="row">
                    <div class="col-md-6 left-div">
                        <label>Unit Number:</label>
                    </div>
                    <div class="col-md-6">
                        <mat-form-field appearance="fill">
                            <mat-label>Select Unit Number</mat-label>
                            <mat-select (selectionChange)="onUnitChange($event)" formControlName="UnitID">
                                <mat-option *ngIf="form.controls.UnitID.value != '' && form.controls.UnitID.value != undefined">None</mat-option>
                                <mat-option *ngIf="form.controls.BuildingID.value == undefined || form.controls.BuildingID.value == ''" disabled>Please select a building first</mat-option>
                                <mat-option *ngIf="unitsList.length == 0 && !(form.controls.BuildingID.value == undefined || form.controls.BuildingID.value == '')" disabled>No Units</mat-option>
                                <mat-option *ngFor="let units of unitsList" [value]="units.UnitID">{{ units.UnitNumber }}</mat-option>                                
                            </mat-select>
                            <mat-hint align="end">Click the dropdown to select</mat-hint>
                            <mat-error *ngIf="form.controls.UnitID.invalid">{{getErrorMessage("unit")}}</mat-error>
                            <mat-error *ngIf="form.controls.UnitID.value == 'none'">Please select a unit</mat-error>
                        </mat-form-field>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-6">
                <!-- <div class="row">
                    <div class="col-md-6 left-div">
                        <label>Payment Method:</label>
                    </div>
                    <div class="col-md-6">
                        <mat-form-field appearance="fill">
                            <mat-label>Select Payment Method</mat-label>
                            <mat-select>
                                <mat-option value="one">First option</mat-option>
                                <mat-option value="two">Second option</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </div> -->
            </div>
            <div class="col-lg-6">
                <!-- <div class="row">
                    <div class="col-md-6 left-div">
                        <label>Unit Number:</label>
                    </div>
                    <div class="col-md-6">
                        <mat-form-field appearance="fill">
                            <mat-label>Select Unit Number</mat-label>
                            <mat-select>
                                <mat-option value="one">First option</mat-option>
                                <mat-option value="two">Second option</mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </div> -->
            </div>
        </div>
        <br>
        <div class="row">
            <h4>Please select a unit before selecting a proof of payment!</h4>
        </div>
        <div class="row control-div">
            <div class="col-md-6 left-div">
                <label>Proof of Payment:</label>
            </div>
            <div class="col-md-6">
                <mat-form-field appearance="fill">
                    <mat-label>Select PoP</mat-label>
                    <mat-select class="selectClass" (selectionChange)="onPoPChange($event)" formControlName="ProofOfPaymentID" [disabled]="!selectUnit">
                        <!-- <mat-option *ngIf="pops.length == 0">No Units</mat-option> -->
                        <mat-option *ngIf="form.controls.UnitID.value == undefined || form.controls.UnitID.value == ''" disabled>Please select a unit first</mat-option>
                        <mat-option *ngIf="pops.length == 0 && !(form.controls.UnitID.value == undefined || form.controls.UnitID.value == '')" disabled>No Proofs</mat-option>
                        <mat-option *ngFor="let proofs of pops" [value]="proofs.ProofOfPayementID">{{ proofs.Month }} {{ proofs.Year }}</mat-option>
                    </mat-select>
                    <mat-hint align="end">Select the PoP associated with this payment.</mat-hint>
                    <mat-error *ngIf="form.controls.ProofOfPaymentID.invalid">{{getErrorMessage("pop")}}</mat-error>
                </mat-form-field>
            </div>
            <!-- <div class="col-md-4">
                <button mat-icon-button disabled aria-label="Example icon button with a open in new tab icon">
                    <a mat-stroked-button [routerLink]="" (click)="ViewPDFClicked()">
                        Click to View Selected PoP
                        <mat-icon>open_in_new</mat-icon>
                    </a>
                </button>
            </div> -->
        </div>
        <div class="row" *ngIf="pop">
            <div class="col-md-5"></div>
            <div class="col-md-2">
                <button mat-icon-button disabled aria-label="Example icon button with a open in new tab icon">
                    <a mat-stroked-button [routerLink]="" (click)="ViewPDFClicked()">
                        Click to View Selected PoP
                        <mat-icon>open_in_new</mat-icon>
                    </a>
                </button>
            </div>
            <div class="col-md-5"></div>
        </div>
        <br>
    </div>

    <div class="bottombuttons">
        <button mat-flat-button color="primary" (click)="clickCancel()">Cancel</button>
        <button mat-flat-button color="primary" type="submit" [disabled]="!form.valid">Capture</button>
    </div>
    </form>
</div>